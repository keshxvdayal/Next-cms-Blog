{"version":3,"file":"VisualEditingComponent-ztNSzo0w.js","sources":["../../src/remix/VisualEditingComponent.tsx"],"sourcesContent":["import { useLocation, useNavigate } from '@remix-run/react'\nimport {\n  enableVisualEditing,\n  type HistoryAdapterNavigate,\n  type VisualEditingOptions,\n} from '@sanity/visual-editing'\nimport { useEffect, useRef, useState } from 'react'\n\n/**\n * @public\n */\nexport interface VisualEditingProps\n  extends Omit<VisualEditingOptions, 'history'> {\n  /**\n   * @deprecated The histoy adapter is already implemented\n   */\n  history?: never\n}\n\nexport default function VisualEditingComponent(\n  props: VisualEditingProps,\n): null {\n  const { zIndex } = props\n\n  const navigateRemix = useNavigate()\n  const navigateRemixRef = useRef(navigateRemix)\n  const [navigate, setNavigate] = useState<HistoryAdapterNavigate | undefined>()\n\n  useEffect(() => {\n    navigateRemixRef.current = navigateRemix\n  }, [navigateRemix])\n  useEffect(() => {\n    const disable = enableVisualEditing({\n      zIndex,\n      history: {\n        subscribe: (_navigate) => {\n          setNavigate(() => _navigate)\n          return () => setNavigate(undefined)\n        },\n        update: (update) => {\n          if (update.type === 'push' || update.type === 'replace') {\n            navigateRemixRef.current(update.url, {\n              replace: update.type === 'replace',\n            })\n          } else if (update.type === 'pop') {\n            navigateRemixRef.current(-1)\n          }\n        },\n      },\n    })\n    return () => disable()\n  }, [zIndex])\n\n  const location = useLocation()\n  useEffect(() => {\n    if (navigate) {\n      navigate({\n        type: 'push',\n        url: `${location.pathname}${location.search}${location.hash}`,\n      })\n    }\n  }, [location.hash, location.pathname, location.search, navigate])\n\n  return null\n}\n"],"names":["VisualEditingComponent","props","zIndex","navigateRemix","useNavigate","navigateRemixRef","useRef","navigate","setNavigate","useState","useEffect","current","disable","enableVisualEditing","history","subscribe","_navigate","update","type","url","replace","location","useLocation","concat","pathname","search","hash"],"mappings":"yLAmBA,SAAwBA,EACtBC,GAEM,MAAAC,OAAEA,GAAWD,EAEbE,EAAgBC,IAChBC,EAAmBC,EAAOH,IACzBI,EAAUC,GAAeC,IAEhCC,GAAU,KACRL,EAAiBM,QAAUR,CAAA,GAC1B,CAACA,IACJO,GAAU,KACR,MAAME,EAAUC,EAAoB,CAClCX,SACAY,QAAS,CACPC,UAAYC,IACVR,GAAY,IAAMQ,IACX,IAAMR,OAAY,IAE3BS,OAASA,IACa,SAAhBA,EAAOC,MAAmC,YAAhBD,EAAOC,KAClBb,EAAAM,QAAQM,EAAOE,IAAK,CACnCC,QAAyB,YAAhBH,EAAOC,OAEO,QAAhBD,EAAOC,MAChBb,EAAiBM,SAAU,EAC7B,KAIN,MAAO,IAAMC,GAAQ,GACpB,CAACV,IAEJ,MAAMmB,EAAWC,IAUV,OATPZ,GAAU,KACJH,GACOA,EAAA,CACPW,KAAM,OACNC,IAAK,GAAGI,OAAAF,EAASG,UAAWD,OAAAF,EAASI,QAASF,OAASF,EAAAK,OAE3D,GACC,CAACL,EAASK,KAAML,EAASG,SAAUH,EAASI,OAAQlB,IAEhD,IACT,QAAAP"}